<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grow with AI - AI-Powered Growth Solutions</title>
    <meta name="description" content="Supercharge your growth with AI-powered solutions. Unlock new possibilities, scale faster, and transform your potential into extraordinary results." />
    <meta name="author" content="Grow with AI" />

    <meta property="og:title" content="Grow with AI - AI-Powered Growth Solutions" />
    <meta property="og:description" content="Supercharge your growth with AI-powered solutions. Unlock new possibilities, scale faster, and transform your potential into extraordinary results." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@growwithai" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    
    <!-- Calendly assets -->
    <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet" />
    <script src="https://assets.calendly.com/assets/external/widget.js" async></script>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Calendly integration script -->
    <script>
    (function(){
      console.log('Calendly integration script loaded');
      
      // Wait for DOM to be ready
      function initCalendlyForm() {
        const form = document.getElementById('consult-form');
        console.log('Looking for form with id consult-form:', form);
        
        if (!form) {
          console.log('Form not found, retrying in 1 second...');
          setTimeout(initCalendlyForm, 1000);
          return;
        }

        console.log('Form found, adding event listener');
        form.addEventListener('submit', async function(e){
          e.preventDefault();
          console.log('Form submitted');

          const first   = (document.getElementById('firstName')||{}).value?.trim() || '';
          const last    = (document.getElementById('lastName')||{}).value?.trim() || '';
          const email   = (document.getElementById('email')||{}).value?.trim() || '';
          const company = (document.getElementById('company')||{}).value?.trim() || '';
          const size    = (document.getElementById('companySize')||{}).value || '';
          const goals   = (document.getElementById('goals')||{}).value?.trim() || '';
          const consent = (document.getElementById('consent')||{}).checked;

          console.log('Form data:', { first, last, email, company, size, goals, consent });

          if (!first || !last || !email || !consent) {
            alert('Please complete First Name, Last Name, Email and Consent.');
            return;
          }

          console.log('Checking Calendly availability:', !!window.Calendly, !!window.Calendly?.initPopupWidget);

          if (window.Calendly && window.Calendly.initPopupWidget) {
            console.log('Opening Calendly popup');
            window.Calendly.initPopupWidget({
              url: 'https://calendly.com/growwith-ai/30min?hide_event_type_details=1&background_color=0b0f16&text_color=ffffff&primary_color=9d00ff',
              prefill: {
                name: `${first} ${last}`,
                email: email,
                customAnswers: {
                  a1: size,      // Calendly Q1: Company Size
                  a2: goals      // Calendly Q2: Automation Goals
                }
              },
              utm: {
                utmSource: 'website',
                utmMedium: 'cta',
                utmCampaign: 'grow-with-ai-consult'
              }
            });
          } else {
            console.error('Calendly not available:', window.Calendly);
            alert('Calendly is still loading. Please try again in a moment.');
          }
        });
      }

      // Try to initialize immediately or when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initCalendlyForm);
      } else {
        initCalendlyForm();
      }

      window.addEventListener('message', function(e){
        if (!e.data || typeof e.data.event !== 'string') return;
        if (e.data.event === 'calendly.event_scheduled') {
          console.log('Calendly booking complete:', e.data);
          // fire analytics events here if needed
        }
      });
    })();
    </script>
  </body>
</html>
